<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Register</title>
    <link rel="stylesheet" th:href="@{/css/login.css}">
    <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
</head>
<body> <p th:if="${message}" th:text="${message}" style="color: red;"></p>
<div class="register">
    <button id="buttonBack" type="button" onclick="window.history.back()"><</i></button>
    <form id="registerForm">
        <h2>Registro</h2>

        <label>Usuario</label>
        <input type="text" id="username" required><br>

        <label>Contraseña</label>
        <input type="password" id="password" required><br>

        <label>Nombre</label>
        <input type="text" id="nombre" required><br>

        <label>Apellido</label>
        <input type="text" id="apellido" required><br>

        <label>DNI</label>
        <input type="text" id="dni" required><br>

        <button type="submit">Registrarse</button>
    </form>

</div>
</body>
</html>

<script>
    document.getElementById('registerForm').addEventListener('submit', function(e) {
        e.preventDefault();
        fetch('/auth/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                username: document.getElementById('username').value,
                password: document.getElementById('password').value,
                name: document.getElementById("nombre").value,
                lastName: document.getElementById("apellido").value,
                dni: document.getElementById("dni").value
            })
        }).then(response => {
            if (response.status === 201) {
                alert('¡Registro exitoso!');
            } else {
                alert('Error al registrar. Intentalo de nuevo.');
            }
        }).catch(error => {
            alert('Ocurrió un error en la solicitud.');
            console.error(error);
        });
    });
</script>
